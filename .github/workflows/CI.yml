name: CI

on:
    push:
        branches:
            - main

jobs: 
    build:

        runs-on: ubuntu-latest

        - name: Set up PHP
            uses: shivammathur/setup-php@v2
            with:
                php-version: '7.4'

        - name: Install dependencies
            run: composer install --prefer-dist --no-progress --no-suggest

        - name: Run PHPUnit tests
            run: vendor/bin/phpunit

        - name: Run PHPStan
            run: vendor/bin/phpstan analyze --level=7 --no-progress